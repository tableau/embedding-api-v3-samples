<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Dynamic Load</title>

    <script type="module">
        import { TableauEventType } from "https://devplat.tableautest.com/javascripts/api/tableau.embedding.3.4.0.js";

        const vizList = ["https://devplat.tableautest.com/views/RegionalSampleWorkbook/Flights",
            "https://devplat.tableautest.com/views/RegionalSampleWorkbook/Obesity",
            "https://devplat.tableautest.com/views/RegionalSampleWorkbook/College",
            "https://devplat.tableautest.com/views/RegionalSampleWorkbook/Stocks",
            "https://devplat.tableautest.com/views/RegionalSampleWorkbook/Storms"];

        let vizLen = vizList.length, vizCount = 0;

        function handleFirstInteractive(e) {
            let previousButton = document.getElementById("previous");
            previousButton.onclick = () => {
                loadViz(-1);
            }
            let nextButton = document.getElementById("next");
            nextButton.onclick = () => {
                loadViz(1);
            }
        }

        function loadViz(vizPlusMinus) {
            vizCount = vizCount + vizPlusMinus;

            if (vizCount >= vizLen) {
                // Keep the vizCount in the bounds of the array index.
                vizCount = 0;
            } else if (vizCount < 0) {
                vizCount = vizLen - 1;
            }

            viz.src = vizList[vizCount];
        }

        let viz = document.getElementById("tableauViz");
        viz.addEventListener(TableauEventType.FirstInteractive, handleFirstInteractive);
        viz.src = vizList[0];
    </script>
</head>

<body>
    <div style="width:800px; height:700px;">
        <tableau-viz id="tableauViz" hide-tabs></tableau-viz>
    </div>
    <div id="controls" style="padding:20px;">
        <button style="width:100px;" id="previous">Previous</button>
        <button style="width:100px;" id="next">Next</button>
    </div>
</body>

</html>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Respond To Events</title>

    <script type="module">
        import { TableauEventType } from "https://devplat.tableautest.com/javascripts/api/tableau.embedding.3.latest.js";

        async function handleMarksSelection(e) {
            const marksCollection = await e.detail.getMarksAsync();
            const marksData = marksCollection.data[0];
            let html = "";

            for (let markIndex = 0; markIndex < marksData.totalRowCount; markIndex++) {
                html += "<b>Mark " + markIndex + ":</b><ul>";

                for (let columnIndex = 0; columnIndex < marksData.columns.length; columnIndex++) {
                    html += "<li><b>Field Name:</b> " + marksData.columns[columnIndex].fieldName;
                    html += "<br/><b>Value:</b> " + marksData.data[markIndex][columnIndex].formattedValue + "</li>";
                }

                html += "</ul>";
            }

            var infoDiv = document.getElementById('markDetails');
            infoDiv.innerHTML = html;
        }

        let viz = document.getElementById("tableauViz");
        viz.addEventListener(TableauEventType.MarkSelectionChanged, handleMarksSelection);
    </script>
</head>

<body>
    <div>
        <tableau-viz id="tableauViz" src="https://devplat.tableautest.com/views/RegionalSampleWorkbook/College"
            hide-tabs>
            <viz-filter field="Academic Year" value="" />
        </tableau-viz>
    </div>
    <br>
    <div id="markDetails">Information about selected marks displays here.</div>
</body>

</html>